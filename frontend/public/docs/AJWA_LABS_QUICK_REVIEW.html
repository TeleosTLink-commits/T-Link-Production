<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T-Link Ajwa Labs - Quick Review Questionnaire</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 10px;
    }

    .header p {
      opacity: 0.9;
      font-size: 14px;
    }

    .content {
      padding: 30px;
    }

    .reviewer-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
      padding: 20px;
      background: #f8fafc;
      border-radius: 8px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      font-weight: 600;
      margin-bottom: 6px;
      color: #374151;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      padding: 10px 14px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .section {
      margin-bottom: 30px;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      background: #1e40af;
      color: white;
      border-radius: 8px 8px 0 0;
      font-weight: 600;
    }

    .section-header .time {
      margin-left: auto;
      font-size: 12px;
      background: rgba(255, 255, 255, 0.2);
      padding: 4px 10px;
      border-radius: 20px;
    }

    .task-table {
      width: 100%;
      border-collapse: collapse;
      border: 1px solid #e5e7eb;
      border-top: none;
    }

    .task-table th,
    .task-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }

    .task-table th {
      background: #f9fafb;
      font-weight: 600;
      color: #374151;
    }

    .task-table tr:hover {
      background: #f8fafc;
    }

    .radio-group {
      display: flex;
      gap: 20px;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .radio-option input[type="radio"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .radio-option.pass {
      color: #059669;
    }

    .radio-option.fail {
      color: #dc2626;
    }

    .notes-input {
      width: 100%;
      padding: 8px 10px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      font-size: 13px;
    }

    .rating-section {
      margin-top: 30px;
    }

    .rating-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .rating-table th,
    .rating-table td {
      padding: 12px 16px;
      border: 1px solid #e5e7eb;
    }

    .rating-table th {
      background: #f9fafb;
      text-align: left;
    }

    .star-rating {
      display: flex;
      gap: 5px;
    }

    .star-rating input[type="radio"] {
      display: none;
    }

    .star-rating label {
      font-size: 24px;
      color: #d1d5db;
      cursor: pointer;
      transition: color 0.2s;
    }

    .star-rating label:hover,
    .star-rating label:hover ~ label,
    .star-rating input:checked ~ label {
      color: #fbbf24;
    }

    .star-rating {
      flex-direction: row-reverse;
      justify-content: flex-end;
    }

    .star-rating input:checked + label,
    .star-rating input:checked + label ~ label {
      color: #fbbf24;
    }

    .feedback-section {
      margin-top: 20px;
    }

    .feedback-section textarea {
      width: 100%;
      min-height: 100px;
      padding: 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 14px;
      resize: vertical;
    }

    .actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e5e7eb;
    }

    .btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: linear-gradient(135deg, #059669 0%, #10b981 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
    }

    .btn-secondary {
      background: #6b7280;
      color: white;
    }

    .btn-secondary:hover {
      background: #4b5563;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .success-message {
      display: none;
      text-align: center;
      padding: 40px;
    }

    .success-message.show {
      display: block;
    }

    .success-icon {
      width: 80px;
      height: 80px;
      background: #d1fae5;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
    }

    .success-icon svg {
      width: 40px;
      height: 40px;
      color: #059669;
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .footer {
      text-align: center;
      padding: 20px;
      background: #f9fafb;
      color: #6b7280;
      font-size: 14px;
    }

    @media (max-width: 600px) {
      .radio-group {
        flex-direction: column;
        gap: 8px;
      }

      .actions {
        flex-direction: column;
      }

      .btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üî¨ T-Link Ajwa Labs</h1>
      <p>Quick Review Questionnaire</p>
    </div>

    <div class="content" id="formContent">
      <!-- Reviewer Information -->
      <div class="reviewer-info">
        <div class="form-group">
          <label for="reviewerName">Reviewer Name *</label>
          <input type="text" id="reviewerName" required placeholder="Enter your full name">
        </div>
        <div class="form-group">
          <label for="reviewerEmail">Email Address *</label>
          <input type="email" id="reviewerEmail" required placeholder="your.email@company.com">
        </div>
        <div class="form-group">
          <label for="reviewDate">Date</label>
          <input type="date" id="reviewDate">
        </div>
        <div class="form-group">
          <label for="browserUsed">Browser Used</label>
          <select id="browserUsed">
            <option value="">Select browser</option>
            <option value="Chrome">Google Chrome</option>
            <option value="Firefox">Mozilla Firefox</option>
            <option value="Safari">Safari</option>
            <option value="Edge">Microsoft Edge</option>
            <option value="Other">Other</option>
          </select>
        </div>
      </div>

      <!-- Section 1: Login & Navigation -->
      <div class="section">
        <div class="section-header">
          <span>1. Login & Navigation</span>
          <span class="time">~2 min</span>
        </div>
        <table class="task-table">
          <thead>
            <tr>
              <th style="width: 50%">Task</th>
              <th style="width: 20%">Result</th>
              <th style="width: 30%">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Can you log in with provided credentials?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task1_1" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task1_1" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes1_1" placeholder="Optional notes"></td>
            </tr>
            <tr>
              <td>Does the dashboard load correctly?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task1_2" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task1_2" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes1_2" placeholder="Optional notes"></td>
            </tr>
            <tr>
              <td>Are all 4 main buttons visible? (CoA Lookup, Inventory Search, Request Shipment, My Shipments)</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task1_3" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task1_3" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes1_3" placeholder="Optional notes"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Section 2: CoA Lookup -->
      <div class="section">
        <div class="section-header">
          <span>2. CoA Lookup</span>
          <span class="time">~1 min</span>
        </div>
        <table class="task-table">
          <thead>
            <tr>
              <th style="width: 50%">Task</th>
              <th style="width: 20%">Result</th>
              <th style="width: 30%">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Can you select a sample from the dropdown?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task2_1" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task2_1" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes2_1" placeholder="Optional notes"></td>
            </tr>
            <tr>
              <td>Does clicking "Get Certificate" return results?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task2_2" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task2_2" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes2_2" placeholder="Optional notes"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Section 3: Inventory Search -->
      <div class="section">
        <div class="section-header">
          <span>3. Inventory Search</span>
          <span class="time">~1 min</span>
        </div>
        <table class="task-table">
          <thead>
            <tr>
              <th style="width: 50%">Task</th>
              <th style="width: 20%">Result</th>
              <th style="width: 30%">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Can you search for a sample?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task3_1" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task3_1" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes3_1" placeholder="Optional notes"></td>
            </tr>
            <tr>
              <td>Does availability info display?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task3_2" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task3_2" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes3_2" placeholder="Optional notes"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Section 4: Request Shipment -->
      <div class="section">
        <div class="section-header">
          <span>4. Request Shipment</span>
          <span class="time">~2 min</span>
        </div>
        <table class="task-table">
          <thead>
            <tr>
              <th style="width: 50%">Task</th>
              <th style="width: 20%">Result</th>
              <th style="width: 30%">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Can you fill in contact & address fields?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task4_1" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task4_1" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes4_1" placeholder="Optional notes"></td>
            </tr>
            <tr>
              <td>Can you add a sample to the request?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task4_2" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task4_2" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes4_2" placeholder="Optional notes"></td>
            </tr>
            <tr>
              <td>Does "Submit Request" work?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task4_3" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task4_3" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes4_3" placeholder="Optional notes"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Section 5: My Shipments -->
      <div class="section">
        <div class="section-header">
          <span>5. My Shipments</span>
          <span class="time">~1 min</span>
        </div>
        <table class="task-table">
          <thead>
            <tr>
              <th style="width: 50%">Task</th>
              <th style="width: 20%">Result</th>
              <th style="width: 30%">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Does the shipments list load?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task5_1" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task5_1" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes5_1" placeholder="Optional notes"></td>
            </tr>
            <tr>
              <td>Can you filter by status?</td>
              <td>
                <div class="radio-group">
                  <label class="radio-option pass">
                    <input type="radio" name="task5_2" value="pass"> ‚úÖ Pass
                  </label>
                  <label class="radio-option fail">
                    <input type="radio" name="task5_2" value="fail"> ‚ùå Fail
                  </label>
                </div>
              </td>
              <td><input type="text" class="notes-input" name="notes5_2" placeholder="Optional notes"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Overall Experience -->
      <div class="section rating-section">
        <div class="section-header">
          <span>6. Overall Experience</span>
        </div>
        <table class="rating-table">
          <thead>
            <tr>
              <th>Criteria</th>
              <th>Rating (1-5)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Ease of use</td>
              <td>
                <div class="star-rating">
                  <input type="radio" id="ease5" name="rating_ease" value="5"><label for="ease5">‚òÖ</label>
                  <input type="radio" id="ease4" name="rating_ease" value="4"><label for="ease4">‚òÖ</label>
                  <input type="radio" id="ease3" name="rating_ease" value="3"><label for="ease3">‚òÖ</label>
                  <input type="radio" id="ease2" name="rating_ease" value="2"><label for="ease2">‚òÖ</label>
                  <input type="radio" id="ease1" name="rating_ease" value="1"><label for="ease1">‚òÖ</label>
                </div>
              </td>
            </tr>
            <tr>
              <td>Visual appearance</td>
              <td>
                <div class="star-rating">
                  <input type="radio" id="visual5" name="rating_visual" value="5"><label for="visual5">‚òÖ</label>
                  <input type="radio" id="visual4" name="rating_visual" value="4"><label for="visual4">‚òÖ</label>
                  <input type="radio" id="visual3" name="rating_visual" value="3"><label for="visual3">‚òÖ</label>
                  <input type="radio" id="visual2" name="rating_visual" value="2"><label for="visual2">‚òÖ</label>
                  <input type="radio" id="visual1" name="rating_visual" value="1"><label for="visual1">‚òÖ</label>
                </div>
              </td>
            </tr>
            <tr>
              <td>Speed/performance</td>
              <td>
                <div class="star-rating">
                  <input type="radio" id="speed5" name="rating_speed" value="5"><label for="speed5">‚òÖ</label>
                  <input type="radio" id="speed4" name="rating_speed" value="4"><label for="speed4">‚òÖ</label>
                  <input type="radio" id="speed3" name="rating_speed" value="3"><label for="speed3">‚òÖ</label>
                  <input type="radio" id="speed2" name="rating_speed" value="2"><label for="speed2">‚òÖ</label>
                  <input type="radio" id="speed1" name="rating_speed" value="1"><label for="speed1">‚òÖ</label>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="feedback-section">
          <div class="form-group">
            <label for="bugsFound">Any bugs or issues found?</label>
            <textarea id="bugsFound" placeholder="Describe any bugs, errors, or issues you encountered..."></textarea>
          </div>
        </div>

        <div class="feedback-section">
          <div class="form-group">
            <label for="suggestions">Suggestions for improvement?</label>
            <textarea id="suggestions" placeholder="Share your ideas for improving the application..."></textarea>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button type="button" class="btn btn-secondary" onclick="saveDraft()">
          üíæ Save Draft
        </button>
        <button type="button" class="btn btn-primary" id="submitBtn" onclick="submitReview()">
          üìß Save & Send Review
        </button>
      </div>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
      <div class="success-icon">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
      </div>
      <h2 style="color: #059669; margin-bottom: 10px;">Review Submitted Successfully!</h2>
      <p style="color: #6b7280;">Your feedback has been sent to Jhunzie@ajwalabs.com</p>
      <p style="color: #6b7280; margin-top: 20px;">Thank you for taking the time to review T-Link.</p>
    </div>

    <div class="footer">
      <p>Estimated time to complete: ~7 minutes</p>
      <p style="margin-top: 5px;">¬© 2026 Ajwa Labs - T-Link Sample Management System</p>
    </div>
  </div>

  <script>
    // Set default date to today
    document.getElementById('reviewDate').valueAsDate = new Date();

    // Collect all form data
    function collectFormData() {
      const data = {
        reviewerName: document.getElementById('reviewerName').value,
        reviewerEmail: document.getElementById('reviewerEmail').value,
        reviewDate: document.getElementById('reviewDate').value,
        browserUsed: document.getElementById('browserUsed').value,
        tasks: {},
        ratings: {},
        bugsFound: document.getElementById('bugsFound').value,
        suggestions: document.getElementById('suggestions').value
      };

      // Collect task results
      const taskInputs = document.querySelectorAll('input[type="radio"]:checked');
      taskInputs.forEach(input => {
        if (input.name.startsWith('task')) {
          data.tasks[input.name] = input.value;
        } else if (input.name.startsWith('rating')) {
          data.ratings[input.name] = input.value;
        }
      });

      // Collect notes
      const notesInputs = document.querySelectorAll('input[name^="notes"]');
      notesInputs.forEach(input => {
        if (input.value) {
          data.tasks[input.name] = input.value;
        }
      });

      return data;
    }

    // Validate form
    function validateForm() {
      const name = document.getElementById('reviewerName').value;
      const email = document.getElementById('reviewerEmail').value;

      if (!name.trim()) {
        alert('Please enter your name.');
        return false;
      }

      if (!email.trim() || !email.includes('@')) {
        alert('Please enter a valid email address.');
        return false;
      }

      return true;
    }

    // Save draft to localStorage
    function saveDraft() {
      const data = collectFormData();
      localStorage.setItem('tlink_review_draft', JSON.stringify(data));
      alert('Draft saved successfully! You can continue later.');
    }

    // Load draft from localStorage
    function loadDraft() {
      const draft = localStorage.getItem('tlink_review_draft');
      if (draft) {
        const data = JSON.parse(draft);
        document.getElementById('reviewerName').value = data.reviewerName || '';
        document.getElementById('reviewerEmail').value = data.reviewerEmail || '';
        document.getElementById('reviewDate').value = data.reviewDate || '';
        document.getElementById('browserUsed').value = data.browserUsed || '';
        document.getElementById('bugsFound').value = data.bugsFound || '';
        document.getElementById('suggestions').value = data.suggestions || '';

        // Restore task selections
        Object.entries(data.tasks || {}).forEach(([name, value]) => {
          const input = document.querySelector(`input[name="${name}"][value="${value}"]`);
          if (input) input.checked = true;
          const notesInput = document.querySelector(`input[name="${name}"]`);
          if (notesInput && notesInput.type === 'text') notesInput.value = value;
        });

        // Restore ratings
        Object.entries(data.ratings || {}).forEach(([name, value]) => {
          const input = document.querySelector(`input[name="${name}"][value="${value}"]`);
          if (input) input.checked = true;
        });
      }
    }

    // Format data for email
    function formatEmailBody(data) {
      let body = `T-LINK QUICK REVIEW QUESTIONNAIRE\n`;
      body += `================================\n\n`;
      body += `Reviewer: ${data.reviewerName}\n`;
      body += `Email: ${data.reviewerEmail}\n`;
      body += `Date: ${data.reviewDate}\n`;
      body += `Browser: ${data.browserUsed}\n\n`;

      body += `TASK RESULTS\n`;
      body += `------------\n`;

      const taskLabels = {
        'task1_1': 'Login with credentials',
        'task1_2': 'Dashboard loads correctly',
        'task1_3': 'All 4 main buttons visible',
        'task2_1': 'Select sample from dropdown',
        'task2_2': 'Get Certificate returns results',
        'task3_1': 'Search for sample',
        'task3_2': 'Availability info displays',
        'task4_1': 'Fill contact & address fields',
        'task4_2': 'Add sample to request',
        'task4_3': 'Submit Request works',
        'task5_1': 'Shipments list loads',
        'task5_2': 'Filter by status'
      };

      Object.entries(taskLabels).forEach(([key, label]) => {
        const result = data.tasks[key] || 'not tested';
        const note = data.tasks[`notes${key.substring(4)}`] || '';
        body += `${label}: ${result.toUpperCase()}${note ? ` (${note})` : ''}\n`;
      });

      body += `\nRATINGS\n`;
      body += `-------\n`;
      body += `Ease of use: ${data.ratings['rating_ease'] || 'N/A'}/5\n`;
      body += `Visual appearance: ${data.ratings['rating_visual'] || 'N/A'}/5\n`;
      body += `Speed/performance: ${data.ratings['rating_speed'] || 'N/A'}/5\n`;

      body += `\nBUGS/ISSUES FOUND\n`;
      body += `-----------------\n`;
      body += `${data.bugsFound || 'None reported'}\n`;

      body += `\nSUGGESTIONS\n`;
      body += `-----------\n`;
      body += `${data.suggestions || 'None provided'}\n`;

      return body;
    }

    // Submit review
    async function submitReview() {
      if (!validateForm()) return;

      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<span class="spinner"></span> Sending...';

      const data = collectFormData();

      try {
        // Send to API endpoint
        const response = await fetch('/api/admin/submit-review', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            to: 'Jhunzie@ajwalabs.com',
            subject: `T-Link Quick Review - ${data.reviewerName} - ${data.reviewDate}`,
            reviewerName: data.reviewerName,
            reviewerEmail: data.reviewerEmail,
            reviewData: data,
            formattedBody: formatEmailBody(data)
          })
        });

        if (response.ok) {
          // Clear draft
          localStorage.removeItem('tlink_review_draft');

          // Show success message
          document.getElementById('formContent').style.display = 'none';
          document.getElementById('successMessage').classList.add('show');
        } else {
          throw new Error('Failed to submit');
        }
      } catch (error) {
        // Fallback to mailto if API fails
        const emailBody = encodeURIComponent(formatEmailBody(data));
        const subject = encodeURIComponent(`T-Link Quick Review - ${data.reviewerName} - ${data.reviewDate}`);
        window.location.href = `mailto:Jhunzie@ajwalabs.com?subject=${subject}&body=${emailBody}`;

        // Clear draft and show success anyway since mailto opened
        localStorage.removeItem('tlink_review_draft');
        document.getElementById('formContent').style.display = 'none';
        document.getElementById('successMessage').classList.add('show');
      }

      submitBtn.disabled = false;
      submitBtn.innerHTML = 'üìß Save & Send Review';
    }

    // Load any saved draft on page load
    window.onload = loadDraft;
  </script>
</body>
</html>
